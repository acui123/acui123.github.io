{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\qd\\blog\\vuepress-blog-demo\\xcui-blog\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!C:\\Users\\Administrator\\Desktop\\qd\\blog\\vuepress-blog-demo\\xcui-blog\\node_modules\\@vssue\\api-github-v4\\lib\\index.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\qd\\blog\\vuepress-blog-demo\\xcui-blog\\node_modules\\@vssue\\api-github-v4\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\qd\\blog\\vuepress-blog-demo\\xcui-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\qd\\blog\\vuepress-blog-demo\\xcui-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9Vc2Vycy9BZG1pbmlzdHJhdG9yL0Rlc2t0b3AvcWQvYmxvZy92dWVwcmVzcy1ibG9nLWRlbW8veGN1aS1ibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJDOi9Vc2Vycy9BZG1pbmlzdHJhdG9yL0Rlc2t0b3AvcWQvYmxvZy92dWVwcmVzcy1ibG9nLWRlbW8veGN1aS1ibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9BZG1pbmlzdHJhdG9yL0Rlc2t0b3AvcWQvYmxvZy92dWVwcmVzcy1ibG9nLWRlbW8veGN1aS1ibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzovVXNlcnMvQWRtaW5pc3RyYXRvci9EZXNrdG9wL3FkL2Jsb2cvdnVlcHJlc3MtYmxvZy1kZW1vL3hjdWktYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZXZlcnNlLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgYnVpbGRVUkwsIGNvbmNhdFVSTCwgZ2V0Q2xlYW5VUkwsIHBhcnNlUXVlcnkgfSBmcm9tICdAdnNzdWUvdXRpbHMnOwppbXBvcnQgeyBub3JtYWxpemVVc2VyLCBub3JtYWxpemVJc3N1ZSwgbm9ybWFsaXplQ29tbWVudCwgbm9ybWFsaXplUmVhY3Rpb25zLCBtYXBSZWFjdGlvbk5hbWUgfSBmcm9tICcuL3V0aWxzJzsKLyoqCiAqIEdpdGh1YiBHcmFwaFFMIEFQSSB2NAogKgogKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvCiAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9leHBsb3Jlci8KICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL2FwcHMvYnVpbGRpbmctb2F1dGgtYXBwcy8KICovCgp2YXIgR2l0aHViVjQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEdpdGh1YlY0KF9yZWYpIHsKICAgIHZhciBfcmVmJGJhc2VVUkwgPSBfcmVmLmJhc2VVUkwsCiAgICAgICAgYmFzZVVSTCA9IF9yZWYkYmFzZVVSTCA9PT0gdm9pZCAwID8gJ2h0dHBzOi8vZ2l0aHViLmNvbScgOiBfcmVmJGJhc2VVUkwsCiAgICAgICAgb3duZXIgPSBfcmVmLm93bmVyLAogICAgICAgIHJlcG8gPSBfcmVmLnJlcG8sCiAgICAgICAgbGFiZWxzID0gX3JlZi5sYWJlbHMsCiAgICAgICAgY2xpZW50SWQgPSBfcmVmLmNsaWVudElkLAogICAgICAgIGNsaWVudFNlY3JldCA9IF9yZWYuY2xpZW50U2VjcmV0LAogICAgICAgIHN0YXRlID0gX3JlZi5zdGF0ZSwKICAgICAgICBwcm94eSA9IF9yZWYucHJveHk7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdpdGh1YlY0KTsKCiAgICBpZiAodHlwZW9mIGNsaWVudFNlY3JldCA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHByb3h5ID09PSAndW5kZWZpbmVkJykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsaWVudFNlY3JldCBhbmQgcHJveHkgaXMgcmVxdWlyZWQgZm9yIEdpdEh1YiBWNCcpOwogICAgfQoKICAgIHRoaXMuYmFzZVVSTCA9IGJhc2VVUkw7CiAgICB0aGlzLm93bmVyID0gb3duZXI7CiAgICB0aGlzLnJlcG8gPSByZXBvOwogICAgdGhpcy5sYWJlbHMgPSBsYWJlbHM7CiAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7CiAgICB0aGlzLmNsaWVudFNlY3JldCA9IGNsaWVudFNlY3JldDsKICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICAgIHRoaXMucHJveHkgPSBwcm94eTsKICAgIHRoaXMuX3BhZ2VJbmZvID0gewogICAgICBwYWdlOiAxLAogICAgICBzdGFydEN1cnNvcjogbnVsbCwKICAgICAgZW5kQ3Vyc29yOiBudWxsLAogICAgICBzb3J0OiBudWxsLAogICAgICBwZXJQYWdlOiBudWxsCiAgICB9OwogICAgdGhpcy5faXNzdWVOb2RlSWQgPSBudWxsOwogICAgdGhpcy4kaHR0cCA9IGF4aW9zLmNyZWF0ZSh7CiAgICAgIGJhc2VVUkw6IGJhc2VVUkwgPT09ICdodHRwczovL2dpdGh1Yi5jb20nID8gJ2h0dHBzOi8vYXBpLmdpdGh1Yi5jb20nIDogY29uY2F0VVJMKGJhc2VVUkwsICdhcGknKSwKICAgICAgaGVhZGVyczogewogICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL3ZuZC5naXRodWIudjMranNvbicKICAgICAgfQogICAgfSk7CiAgICB0aGlzLiRodHRwLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIGlmIChyZXNwb25zZS5kYXRhLmVycm9yKSB7CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3BvbnNlLmRhdGEuZXJyb3JfZGVzY3JpcHRpb24pOwogICAgICB9CgogICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcnMpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzcG9uc2UuZGF0YS5lcnJvcnNbMF0ubWVzc2FnZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0pOwogIH0KICAvKioKICAgKiBUaGUgcGxhdGZvcm0gYXBpIGluZm8KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhHaXRodWJWNCwgW3sKICAgIGtleTogInBsYXRmb3JtIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICdHaXRIdWInLAogICAgICAgIGxpbms6IHRoaXMuYmFzZVVSTCwKICAgICAgICB2ZXJzaW9uOiAndjQnLAogICAgICAgIG1ldGE6IHsKICAgICAgICAgIHJlYWN0YWJsZTogdHJ1ZSwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfQogICAgICB9OwogICAgfQogICAgLyoqCiAgICAgKiBSZWRpcmVjdCB0byB0aGUgYXV0aG9yaXphdGlvbiBwYWdlIG9mIHBsYXRmb3JtLgogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS9hcHBzL2J1aWxkaW5nLW9hdXRoLWFwcHMvYXV0aG9yaXppbmctb2F1dGgtYXBwcy8jMS1yZXF1ZXN0LWEtdXNlcnMtZ2l0aHViLWlkZW50aXR5CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVkaXJlY3RBdXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWRpcmVjdEF1dGgoKSB7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYnVpbGRVUkwoY29uY2F0VVJMKHRoaXMuYmFzZVVSTCwgJ2xvZ2luL29hdXRoL2F1dGhvcml6ZScpLCB7CiAgICAgICAgY2xpZW50X2lkOiB0aGlzLmNsaWVudElkLAogICAgICAgIHJlZGlyZWN0X3VyaTogd2luZG93LmxvY2F0aW9uLmhyZWYsCiAgICAgICAgc2NvcGU6ICdwdWJsaWNfcmVwbycsCiAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIEhhbmRsZSBhdXRob3JpemF0aW9uLgogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS9hcHBzL2J1aWxkaW5nLW9hdXRoLWFwcHMvYXV0aG9yaXppbmctb2F1dGgtYXBwcy8KICAgICAqCiAgICAgKiBAcmVtYXJrcwogICAgICogSWYgdGhlIGBjb2RlYCBhbmQgYHN0YXRlYCBleGlzdCBpbiB0aGUgcXVlcnksIGFuZCB0aGUgYHN0YXRlYCBtYXRjaGVzLCByZW1vdmUgdGhlbSBmcm9tIHF1ZXJ5LCBhbmQgdHJ5IHRvIGdldCB0aGUgYWNjZXNzIHRva2VuLgogICAgICovCgogIH0sIHsKICAgIGtleTogImhhbmRsZUF1dGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9oYW5kbGVBdXRoID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBxdWVyeSwgY29kZSwgcmVwbGFjZVVSTCwgYWNjZXNzVG9rZW47CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcXVlcnkgPSBwYXJzZVF1ZXJ5KHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpOwoKICAgICAgICAgICAgICAgIGlmICghcXVlcnkuY29kZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghKHF1ZXJ5LnN0YXRlICE9PSB0aGlzLnN0YXRlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGNvZGUgPSBxdWVyeS5jb2RlOwogICAgICAgICAgICAgICAgZGVsZXRlIHF1ZXJ5LmNvZGU7CiAgICAgICAgICAgICAgICBkZWxldGUgcXVlcnkuc3RhdGU7CiAgICAgICAgICAgICAgICByZXBsYWNlVVJMID0gYnVpbGRVUkwoZ2V0Q2xlYW5VUkwod2luZG93LmxvY2F0aW9uLmhyZWYpLCBxdWVyeSkgKyB3aW5kb3cubG9jYXRpb24uaGFzaDsKICAgICAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCAnJywgcmVwbGFjZVVSTCk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRBY2Nlc3NUb2tlbih7CiAgICAgICAgICAgICAgICAgIGNvZGU6IGNvZGUKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgYWNjZXNzVG9rZW4pOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlQXV0aCgpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZUF1dGguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhhbmRsZUF1dGg7CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IHVzZXIgYWNjZXNzIHRva2VuIHZpYSBgY29kZWAKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vYXBwcy9idWlsZGluZy1vYXV0aC1hcHBzL2F1dGhvcml6aW5nLW9hdXRoLWFwcHMvIzItdXNlcnMtYXJlLXJlZGlyZWN0ZWQtYmFjay10by15b3VyLXNpdGUtYnktZ2l0aHViCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0QWNjZXNzVG9rZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRBY2Nlc3NUb2tlbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoX3JlZjIpIHsKICAgICAgICB2YXIgY29kZSwgb3JpZ2luYWxVUkwsIHByb3h5VVJMLCBfeWllbGQkdGhpcyQkaHR0cCRwb3MsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb2RlID0gX3JlZjIuY29kZTsKCiAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAqIGFjY2Vzc190b2tlbiBhcGkgZG9lcyBub3Qgc3VwcG9ydCBjb3JzCiAgICAgICAgICAgICAgICAgKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9pc2FhY3MvZ2l0aHViL2lzc3Vlcy8zMzAKICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgb3JpZ2luYWxVUkwgPSBjb25jYXRVUkwodGhpcy5iYXNlVVJMLCAnbG9naW4vb2F1dGgvYWNjZXNzX3Rva2VuJyk7CiAgICAgICAgICAgICAgICBwcm94eVVSTCA9IHR5cGVvZiB0aGlzLnByb3h5ID09PSAnZnVuY3Rpb24nID8gdGhpcy5wcm94eShvcmlnaW5hbFVSTCkgOiB0aGlzLnByb3h5OwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdChwcm94eVVSTCwgewogICAgICAgICAgICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY2xpZW50SWQsCiAgICAgICAgICAgICAgICAgIGNsaWVudF9zZWNyZXQ6IHRoaXMuY2xpZW50U2VjcmV0LAogICAgICAgICAgICAgICAgICBjb2RlOiBjb2RlCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zLmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgZGF0YS5hY2Nlc3NfdG9rZW4pOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbihfeCkgewogICAgICAgIHJldHVybiBfZ2V0QWNjZXNzVG9rZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldEFjY2Vzc1Rva2VuOwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCB0aGUgbG9nZ2VkLWluIHVzZXIgd2l0aCBhY2Nlc3MgdG9rZW4uCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L3F1ZXJ5LyB2aWV3ZXIKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9vYmplY3QvdXNlci8KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRVc2VyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0VXNlciA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoX3JlZjMpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIF95aWVsZCR0aGlzJCRodHRwJHBvczIsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWYzLmFjY2Vzc1Rva2VuOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgnZ3JhcGhxbCcsIHsKICAgICAgICAgICAgICAgICAgcXVlcnk6ICJxdWVyeSBnZXRVc2VyIHtcbiAgdmlld2VyIHtcbiAgICBsb2dpblxuICAgIGF2YXRhclVybFxuICAgIHVybFxuICB9XG59IgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogInRva2VuICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zMiA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHBvczIuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVVc2VyKGRhdGEuZGF0YS52aWV3ZXIpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0VXNlcihfeDIpIHsKICAgICAgICByZXR1cm4gX2dldFVzZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldFVzZXI7CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IGlzc3VlIG9mIHRoaXMgcGFnZSBhY2NvcmRpbmcgdG8gdGhlIGlzc3VlIGlkIG9yIHRoZSBpc3N1ZSB0aXRsZQogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9vYmplY3QvcmVwb3NpdG9yeS8KICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9vYmplY3QvaXNzdWVjb25uZWN0aW9uLwogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L29iamVjdC9pc3N1ZS8KICAgICAqCiAgICAgKiBAcmVtYXJrcwogICAgICogVGhlIElzc3VlQ29ubmVjdGlvbiBkb2VzIG5vdCBoYXZlIHRpdGxlIGZpbHRlciBmb3Igbm93LCBhbmQgdGhlIG51bWJlciBvZiByZXN1bHRzIGlzIGxpbWl0ZWQgdG8gMTAwLgogICAgICogRm9yIG5vdywgaWYgaXNzdWVzIHdpdGggdGhlIGxhYmVscyBhcmUgbW9yZSB0aGFuIDEwMCwgd2UgaGF2ZSB0byByZXF1ZXN0IHRoZSBuZXh0IHBhZ2Uobm90IGltcGxlbWVudGVkIHlldCkuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0SXNzdWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRJc3N1ZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoX3JlZjQpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIGlzc3VlVGl0bGUsIG9wdGlvbnMsIF95aWVsZCR0aGlzJCRodHRwJHBvczMsIGRhdGEsIHF1ZXJ5LCBfeWllbGQkdGhpcyQkaHR0cCRwb3M0LCBfZGF0YSwgaXNzdWU7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY0LmFjY2Vzc1Rva2VuLCBpc3N1ZUlkID0gX3JlZjQuaXNzdWVJZCwgaXNzdWVUaXRsZSA9IF9yZWY0Lmlzc3VlVGl0bGU7CiAgICAgICAgICAgICAgICBvcHRpb25zID0ge307CgogICAgICAgICAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7CiAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAidG9rZW4gIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCFpc3N1ZUlkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gNDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoImdyYXBocWwiLCB7CiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAicXVlcnkgZ2V0SXNzdWVCeUlkIHtcbiAgcmVwb3NpdG9yeShvd25lcjogXCIiLmNvbmNhdCh0aGlzLm93bmVyLCAiXCIsIG5hbWU6IFwiIikuY29uY2F0KHRoaXMucmVwbywgIlwiKSB7XG4gICAgaXNzdWUgKG51bWJlcjogIikuY29uY2F0KGlzc3VlSWQsICIpIHtcbiAgICAgIGlkXG4gICAgICBudW1iZXJcbiAgICAgIHRpdGxlXG4gICAgICBib2R5XG4gICAgICB1cmxcbiAgICB9XG4gIH1cbn0iKQogICAgICAgICAgICAgICAgfSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczMgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3MzLmRhdGE7CiAgICAgICAgICAgICAgICAvLyBwb3N0Q29tbWVudCBuZWVkcyBpc3N1ZSBOb2RlSWQsIHNvIHdlIHN0b3JlIGl0IGludGVybmFsbHkKICAgICAgICAgICAgICAgIHRoaXMuX2lzc3VlTm9kZUlkID0gZGF0YS5kYXRhLnJlcG9zaXRvcnkuaXNzdWUuaWQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplSXNzdWUoZGF0YS5kYXRhLnJlcG9zaXRvcnkuaXNzdWUpKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTM7CiAgICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbImNhdGNoIl0oNCk7CgogICAgICAgICAgICAgICAgaWYgKCEoX2NvbnRleHQ0LnQwLnJlc3BvbnNlICYmIF9jb250ZXh0NC50MC5yZXNwb25zZS5zdGF0dXMgPT09IDQwNCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQ0LnQwOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgICAgcXVlcnkgPSBbIlwiIi5jb25jYXQoaXNzdWVUaXRsZSwgIlwiIiksICJpbjp0aXRsZSIsICJyZXBvOiIuY29uY2F0KHRoaXMub3duZXIsICIvIikuY29uY2F0KHRoaXMucmVwbyksICJpczpwdWJsaWMiXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMubGFiZWxzLm1hcChmdW5jdGlvbiAobGFiZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuICJsYWJlbDoiLmNvbmNhdChsYWJlbCk7CiAgICAgICAgICAgICAgICB9KSkpLmpvaW4oJyAnKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KCJncmFwaHFsIiwgewogICAgICAgICAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgICAgICAgICBxdWVyeTogcXVlcnkKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcXVlcnk6ICJxdWVyeSBnZXRJc3N1ZUJ5VGl0bGUoXG4gICRxdWVyeTogU3RyaW5nIVxuKSB7XG4gIHNlYXJjaChcbiAgICBxdWVyeTogJHF1ZXJ5XG4gICAgdHlwZTogSVNTVUVcbiAgICBmaXJzdDogMjBcbiAgICApIHtcbiAgICAgIG5vZGVzIHtcbiAgICAgIC4uLiBvbiBJc3N1ZSB7XG4gICAgICAgIGlkXG4gICAgICAgIG51bWJlclxuICAgICAgICB0aXRsZVxuICAgICAgICBib2R5XG4gICAgICAgIHVybFxuICAgICAgfVxuICAgIH1cbiAgfVxufSIKICAgICAgICAgICAgICAgIH0sIG9wdGlvbnMpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zNCA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgX2RhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3M0LmRhdGE7CiAgICAgICAgICAgICAgICBpc3N1ZSA9IF9kYXRhLmRhdGEuc2VhcmNoLm5vZGVzLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udGl0bGUgPT09IGlzc3VlVGl0bGU7CiAgICAgICAgICAgICAgICB9KTsgLy8gcG9zdENvbW1lbnQgbmVlZHMgaXNzdWUgTm9kZUlkLCBzbyB3ZSBzdG9yZSBpdCBpbnRlcm5hbGx5CgogICAgICAgICAgICAgICAgaWYgKCFpc3N1ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDMxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLl9pc3N1ZU5vZGVJZCA9IGlzc3VlLmlkOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZUlzc3VlKGlzc3VlKSk7CgogICAgICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMsIFtbNCwgMTNdXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldElzc3VlKF94MykgewogICAgICAgIHJldHVybiBfZ2V0SXNzdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldElzc3VlOwogICAgfSgpCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBpc3N1ZQogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9tdXRhdGlvbi9jcmVhdGVpc3N1ZS8KICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9pbnB1dF9vYmplY3QvY3JlYXRlaXNzdWVpbnB1dC8KICAgICAqCiAgICAgKiBAcmVtYXJrcwogICAgICogQ3JlYXRpbmcgaXNzdWUgcmVxdWlyZXMgcmVwb3NpdG9yeUlkLCB3aGljaCBzaG91bGQgYmUgcmVxdWVzdGVkIGluIGFuIGV4dHJhIHJlcXVlc3QuCiAgICAgKiBDcmVhdGluZyBpc3N1ZSB3aXRoIGxhYmVscyByZXF1aXJlcyBsYWJlbElkcywgd2hpY2ggc2hvdWxkIGJlIHJlcXVlc3RlZCBpbiBhbiBleHRyYSByZXF1ZXN0LCBvciBjcmVhdGUgdGhlIGxhYmVsIGlmIGl0IGRvZXMgbm90IGV4aXN0LgogICAgICogRW5kcG9pbnRzIGZvciBjcmVhdGluZyBsYWJlbHMgaGFzIG5vdCBiZWVuIGltcGxlbWVudGVkIGJ5IEdpdEh1YiB5ZXQgKHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L211dGF0aW9uL2NyZWF0ZWxhYmVsLykKICAgICAqCiAgICAgKiBGb3IgdGhlc2UgcmVhc29ucywgZmFsbGJhY2sgdG8gdjMgZm9yIG5vdwogICAgICovCgogIH0sIHsKICAgIGtleTogInBvc3RJc3N1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Bvc3RJc3N1ZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoX3JlZjUpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIHRpdGxlLCBjb250ZW50LCBfeWllbGQkdGhpcyQkaHR0cCRwb3M1LCBkYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmNS5hY2Nlc3NUb2tlbiwgdGl0bGUgPSBfcmVmNS50aXRsZSwgY29udGVudCA9IF9yZWY1LmNvbnRlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KCJyZXBvcy8iLmNvbmNhdCh0aGlzLm93bmVyLCAiLyIpLmNvbmNhdCh0aGlzLnJlcG8sICIvaXNzdWVzIiksIHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLAogICAgICAgICAgICAgICAgICBib2R5OiBjb250ZW50LAogICAgICAgICAgICAgICAgICBsYWJlbHM6IHRoaXMubGFiZWxzCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAidG9rZW4gIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3M1ID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zNS5kYXRhOwogICAgICAgICAgICAgICAgLy8gYGh0bWxfdXJsYCBpbiB2MwogICAgICAgICAgICAgICAgLy8gYHVybGAgaW4gdjQKICAgICAgICAgICAgICAgIGRhdGEudXJsID0gZGF0YS5odG1sX3VybDsgLy8gcG9zdENvbW1lbnQgbmVlZHMgaXNzdWUgTm9kZUlkLCBzbyB3ZSBzdG9yZSBpdCBpbnRlcm5hbGx5CgogICAgICAgICAgICAgICAgdGhpcy5faXNzdWVOb2RlSWQgPSBkYXRhLm5vZGVfaWQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplSXNzdWUoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwb3N0SXNzdWUoX3g0KSB7CiAgICAgICAgcmV0dXJuIF9wb3N0SXNzdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvc3RJc3N1ZTsKICAgIH0oKQogICAgLyoqCiAgICAgKiBHZXQgY29tbWVudHMgb2YgdGhpcyBwYWdlIGFjY29yZGluZyB0byB0aGUgaXNzdWUgaWQKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvb2JqZWN0L2lzc3VlY29tbWVudGNvbm5lY3Rpb24vCiAgICAgKgogICAgICogQHJlbWFya3MKICAgICAqIE5vIG9mZnNldCBpbXBsZW1lbnRlZCwgc28gaXQncyBkaWZmaWN1bHQgdG8gaW1wbGVtZW50IFJFU1QtbGlrZSBwYWdpbmF0aW9uCiAgICAgKiBGb3Igbm93LCB3ZSB1c2UgYW4gaW50ZXJuYWwgYF9wYWdlSW5mb2AgdmFyIHRvIGhhY2sgdGhhdAogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENvbW1lbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0Q29tbWVudHMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KF9yZWY2KSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBpc3N1ZUlkLCBfcmVmNiRxdWVyeSwgX3JlZjYkcXVlcnkkcGFnZSwgcGFnZSwgX3JlZjYkcXVlcnkkcGVyUGFnZSwgcGVyUGFnZSwgX3JlZjYkcXVlcnkkc29ydCwgc29ydCwgb3B0aW9ucywgX3RoaXMkX2dldFF1ZXJ5UGFyYW1zLCBmaXJzdE9yTGFzdCwgYWZ0ZXJPckJlZm9yZSwgY3Vyc29yLCBfeWllbGQkdGhpcyQkaHR0cCRwb3M2LCBkYXRhLCBjb21tZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjYuYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmNi5pc3N1ZUlkLCBfcmVmNiRxdWVyeSA9IF9yZWY2LnF1ZXJ5OwogICAgICAgICAgICAgICAgX3JlZjYkcXVlcnkgPSBfcmVmNiRxdWVyeSA9PT0gdm9pZCAwID8ge30gOiBfcmVmNiRxdWVyeTsKICAgICAgICAgICAgICAgIF9yZWY2JHF1ZXJ5JHBhZ2UgPSBfcmVmNiRxdWVyeS5wYWdlLCBwYWdlID0gX3JlZjYkcXVlcnkkcGFnZSA9PT0gdm9pZCAwID8gMSA6IF9yZWY2JHF1ZXJ5JHBhZ2UsIF9yZWY2JHF1ZXJ5JHBlclBhZ2UgPSBfcmVmNiRxdWVyeS5wZXJQYWdlLCBwZXJQYWdlID0gX3JlZjYkcXVlcnkkcGVyUGFnZSA9PT0gdm9pZCAwID8gMTAgOiBfcmVmNiRxdWVyeSRwZXJQYWdlLCBfcmVmNiRxdWVyeSRzb3J0ID0gX3JlZjYkcXVlcnkuc29ydCwgc29ydCA9IF9yZWY2JHF1ZXJ5JHNvcnQgPT09IHZvaWQgMCA/ICdkZXNjJyA6IF9yZWY2JHF1ZXJ5JHNvcnQ7CiAgICAgICAgICAgICAgICBvcHRpb25zID0ge307CgogICAgICAgICAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7CiAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAidG9rZW4gIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuX3BhZ2VJbmZvLnNvcnQgIT09IG51bGwgJiYgc29ydCAhPT0gdGhpcy5fcGFnZUluZm8uc29ydCkgewogICAgICAgICAgICAgICAgICBwYWdlID0gMTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMgPSB0aGlzLl9nZXRRdWVyeVBhcmFtcyh7CiAgICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsCiAgICAgICAgICAgICAgICAgIHNvcnQ6IHNvcnQKICAgICAgICAgICAgICAgIH0pLCBmaXJzdE9yTGFzdCA9IF90aGlzJF9nZXRRdWVyeVBhcmFtcy5maXJzdE9yTGFzdCwgYWZ0ZXJPckJlZm9yZSA9IF90aGlzJF9nZXRRdWVyeVBhcmFtcy5hZnRlck9yQmVmb3JlLCBjdXJzb3IgPSBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMuY3Vyc29yOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgiZ3JhcGhxbCIsIHsKICAgICAgICAgICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgICAgICAgICAgb3duZXI6IHRoaXMub3duZXIsCiAgICAgICAgICAgICAgICAgICAgcmVwbzogdGhpcy5yZXBvLAogICAgICAgICAgICAgICAgICAgIGlzc3VlSWQ6IGlzc3VlSWQsCiAgICAgICAgICAgICAgICAgICAgcGVyUGFnZTogcGVyUGFnZQogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBxdWVyeTogInF1ZXJ5IGdldENvbW1lbnRzKFxuICAkb3duZXI6IFN0cmluZyFcbiAgJHJlcG86IFN0cmluZyFcbiAgJGlzc3VlSWQ6IEludCFcbiAgJHBlclBhZ2U6IEludCFcbikge1xuICByZXBvc2l0b3J5KG93bmVyOiAkb3duZXIsIG5hbWU6ICRyZXBvKSB7XG4gICAgaXNzdWUobnVtYmVyOiAkaXNzdWVJZCkge1xuICAgICAgY29tbWVudHMoXG4gICAgICAgICIuY29uY2F0KGZpcnN0T3JMYXN0LCAiOiAkcGVyUGFnZVxuICAgICAgICAiKS5jb25jYXQoYWZ0ZXJPckJlZm9yZSA9PT0gbnVsbCA/ICcnIDogIiIuY29uY2F0KGFmdGVyT3JCZWZvcmUsICI6IFwiIikuY29uY2F0KGN1cnNvciwgIlwiIiksICJcbiAgICAgICkge1xuICAgICAgICB0b3RhbENvdW50XG4gICAgICAgIHBhZ2VJbmZvIHtcbiAgICAgICAgICBlbmRDdXJzb3JcbiAgICAgICAgICBzdGFydEN1cnNvclxuICAgICAgICB9XG4gICAgICAgIG5vZGVzIHtcbiAgICAgICAgICBpZFxuICAgICAgICAgIGJvZHlcbiAgICAgICAgICBib2R5SFRNTFxuICAgICAgICAgIGNyZWF0ZWRBdFxuICAgICAgICAgIHVwZGF0ZWRBdFxuICAgICAgICAgIGF1dGhvciB7XG4gICAgICAgICAgICBhdmF0YXJVcmxcbiAgICAgICAgICAgIGxvZ2luXG4gICAgICAgICAgICB1cmxcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVhY3Rpb25Hcm91cHMge1xuICAgICAgICAgICAgdXNlcnMgKGZpcnN0OiAwKSB7XG4gICAgICAgICAgICAgIHRvdGFsQ291bnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRlbnRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0iKQogICAgICAgICAgICAgICAgfSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczYgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3M2LmRhdGE7CiAgICAgICAgICAgICAgICBjb21tZW50cyA9IGRhdGEuZGF0YS5yZXBvc2l0b3J5Lmlzc3VlLmNvbW1lbnRzOwoKICAgICAgICAgICAgICAgIGlmIChzb3J0ID09PSAnZGVzYycpIHsKICAgICAgICAgICAgICAgICAgY29tbWVudHMubm9kZXMucmV2ZXJzZSgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuX3BhZ2VJbmZvID0gewogICAgICAgICAgICAgICAgICBwYWdlOiBwYWdlLAogICAgICAgICAgICAgICAgICBzdGFydEN1cnNvcjogY29tbWVudHMucGFnZUluZm8uc3RhcnRDdXJzb3IsCiAgICAgICAgICAgICAgICAgIGVuZEN1cnNvcjogY29tbWVudHMucGFnZUluZm8uZW5kQ3Vyc29yLAogICAgICAgICAgICAgICAgICBzb3J0OiBzb3J0LAogICAgICAgICAgICAgICAgICBwZXJQYWdlOiBwZXJQYWdlCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgY291bnQ6IGNvbW1lbnRzLnRvdGFsQ291bnQsCiAgICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsCiAgICAgICAgICAgICAgICAgIHBlclBhZ2U6IHBlclBhZ2UsCiAgICAgICAgICAgICAgICAgIGRhdGE6IGNvbW1lbnRzLm5vZGVzLm1hcChub3JtYWxpemVDb21tZW50KQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRDb21tZW50cyhfeDUpIHsKICAgICAgICByZXR1cm4gX2dldENvbW1lbnRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRDb21tZW50czsKICAgIH0oKQogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9tdXRhdGlvbi9hZGRjb21tZW50LwogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L2lucHV0X29iamVjdC9hZGRjb21tZW50aW5wdXQvCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicG9zdENvbW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9wb3N0Q29tbWVudCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoX3JlZjcpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGNvbnRlbnQsIF95aWVsZCR0aGlzJCRodHRwJHBvczcsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY3LmFjY2Vzc1Rva2VuLCBjb250ZW50ID0gX3JlZjcuY29udGVudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoImdyYXBocWwiLCB7CiAgICAgICAgICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICAgICAgICAgIC8vIHBvc3RDb21tZW50IG5lZWRzIGlzc3VlIE5vZGVJZCwgc28gd2Ugc3RvcmUgaXQgaW50ZXJuYWxseQogICAgICAgICAgICAgICAgICAgIGlzc3VlTm9kZUlkOiB0aGlzLl9pc3N1ZU5vZGVJZCwKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAibXV0YXRpb24gcG9zdENvbW1lbnQoXG4gICRpc3N1ZU5vZGVJZDogSUQhXG4gICRjb250ZW50OiBTdHJpbmchXG4pIHtcbiAgYWRkQ29tbWVudChcbiAgICBpbnB1dDoge1xuICAgICAgc3ViamVjdElkOiAkaXNzdWVOb2RlSWRcbiAgICAgIGJvZHk6ICRjb250ZW50XG4gICAgfVxuICApIHtcbiAgICBjb21tZW50RWRnZSB7XG4gICAgICBub2RlIHtcbiAgICAgICAgaWRcbiAgICAgICAgYm9keVxuICAgICAgICBib2R5SFRNTFxuICAgICAgICBjcmVhdGVkQXRcbiAgICAgICAgdXBkYXRlZEF0XG4gICAgICAgIGF1dGhvciB7XG4gICAgICAgICAgYXZhdGFyVXJsXG4gICAgICAgICAgbG9naW5cbiAgICAgICAgICB1cmxcbiAgICAgICAgfVxuICAgICAgICByZWFjdGlvbkdyb3VwcyB7XG4gICAgICAgICAgdXNlcnMgKGZpcnN0OiAwKSB7XG4gICAgICAgICAgICB0b3RhbENvdW50XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnRlbnRcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufSIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczcgPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3M3LmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplQ29tbWVudChkYXRhLmRhdGEuYWRkQ29tbWVudC5jb21tZW50RWRnZS5ub2RlKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHBvc3RDb21tZW50KF94NikgewogICAgICAgIHJldHVybiBfcG9zdENvbW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvc3RDb21tZW50OwogICAgfSgpCiAgICAvKioKICAgICAqIEVkaXQgYSBjb21tZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L211dGF0aW9uL3VwZGF0ZWlzc3VlY29tbWVudC8KICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9pbnB1dF9vYmplY3QvdXBkYXRlaXNzdWVjb21tZW50aW5wdXQvCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicHV0Q29tbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3B1dENvbW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KF9yZWY4KSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBjb21tZW50SWQsIGNvbnRlbnQsIF95aWVsZCR0aGlzJCRodHRwJHBvczgsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY4LmFjY2Vzc1Rva2VuLCBjb21tZW50SWQgPSBfcmVmOC5jb21tZW50SWQsIGNvbnRlbnQgPSBfcmVmOC5jb250ZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgiZ3JhcGhxbCIsIHsKICAgICAgICAgICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudElkOiBjb21tZW50SWQsCiAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBxdWVyeTogIm11dGF0aW9uIHB1dENvbW1lbnQoXG4gICRjb21tZW50SWQ6IElEISxcbiAgJGNvbnRlbnQ6IFN0cmluZyEsXG4pIHtcbiAgdXBkYXRlSXNzdWVDb21tZW50KGlucHV0OiB7XG4gICAgaWQ6ICRjb21tZW50SWRcbiAgICBib2R5OiAkY29udGVudFxuICB9KSB7XG4gICAgaXNzdWVDb21tZW50IHtcbiAgICAgIGlkXG4gICAgICBib2R5XG4gICAgICBib2R5SFRNTFxuICAgICAgY3JlYXRlZEF0XG4gICAgICB1cGRhdGVkQXRcbiAgICAgIGF1dGhvciB7XG4gICAgICAgIGF2YXRhclVybFxuICAgICAgICBsb2dpblxuICAgICAgICB1cmxcbiAgICAgIH1cbiAgICAgIHJlYWN0aW9uR3JvdXBzIHtcbiAgICAgICAgdXNlcnMgKGZpcnN0OiAwKSB7XG4gICAgICAgICAgdG90YWxDb3VudFxuICAgICAgICB9XG4gICAgICAgIGNvbnRlbnRcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0iCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAidG9rZW4gIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3M4ID0gX2NvbnRleHQ4LnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zOC5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZUNvbW1lbnQoZGF0YS5kYXRhLnVwZGF0ZUlzc3VlQ29tbWVudC5pc3N1ZUNvbW1lbnQpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcHV0Q29tbWVudChfeDcpIHsKICAgICAgICByZXR1cm4gX3B1dENvbW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHB1dENvbW1lbnQ7CiAgICB9KCkKICAgIC8qKgogICAgICogRGVsZXRlIGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9tdXRhdGlvbi9kZWxldGVpc3N1ZWNvbW1lbnQvCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGVsZXRlQ29tbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2RlbGV0ZUNvbW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KF9yZWY5KSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBjb21tZW50SWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjkuYWNjZXNzVG9rZW4sIGNvbW1lbnRJZCA9IF9yZWY5LmNvbW1lbnRJZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoImdyYXBocWwiLCB7CiAgICAgICAgICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRJZDogY29tbWVudElkCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAibXV0YXRpb24gZGVsZXRlQ29tbWVudChcbiAgJGNvbW1lbnRJZDogSUQhLFxuKSB7XG4gIGRlbGV0ZUlzc3VlQ29tbWVudChpbnB1dDoge1xuICAgIGlkOiAkY29tbWVudElkXG4gIH0pIHtcbiAgICBjbGllbnRNdXRhdGlvbklkXG4gIH1cbn0iCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAidG9rZW4gIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIiwgdHJ1ZSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGRlbGV0ZUNvbW1lbnQoX3g4KSB7CiAgICAgICAgcmV0dXJuIF9kZWxldGVDb21tZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZWxldGVDb21tZW50OwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCByZWFjdGlvbnMgb2YgYSBjb21tZW50CiAgICAgKgogICAgICogQHJlbWFya3MKICAgICAqIFRoaXMgcXVlcnkgaGFzIG5vdCBiZWVuIGltcGxlbWVudGVkLCB1c2UgdGhlIGNvbW1lbnRzIHF1ZXJ5IGluc3RlYWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDb21tZW50UmVhY3Rpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0Q29tbWVudFJlYWN0aW9ucyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKF9yZWYxMCkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgY29tbWVudElkLCBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMyLCBmaXJzdE9yTGFzdCwgYWZ0ZXJPckJlZm9yZSwgY3Vyc29yLCBfeWllbGQkdGhpcyQkaHR0cCRwb3M5LCBkYXRhLCBjb21tZW50OwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjEwLmFjY2Vzc1Rva2VuLCBpc3N1ZUlkID0gX3JlZjEwLmlzc3VlSWQsIGNvbW1lbnRJZCA9IF9yZWYxMC5jb21tZW50SWQ7CiAgICAgICAgICAgICAgICBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMyID0gdGhpcy5fZ2V0UXVlcnlQYXJhbXMoKSwgZmlyc3RPckxhc3QgPSBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMyLmZpcnN0T3JMYXN0LCBhZnRlck9yQmVmb3JlID0gX3RoaXMkX2dldFF1ZXJ5UGFyYW1zMi5hZnRlck9yQmVmb3JlLCBjdXJzb3IgPSBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMyLmN1cnNvcjsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KCJncmFwaHFsIiwgewogICAgICAgICAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgICAgICAgICBvd25lcjogdGhpcy5vd25lciwKICAgICAgICAgICAgICAgICAgICByZXBvOiB0aGlzLnJlcG8sCiAgICAgICAgICAgICAgICAgICAgaXNzdWVJZDogaXNzdWVJZCwKICAgICAgICAgICAgICAgICAgICBwZXJQYWdlOiB0aGlzLl9wYWdlSW5mby5wZXJQYWdlCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAicXVlcnkgZ2V0Q29tbWVudHMoXG4gICRvd25lcjogU3RyaW5nIVxuICAkcmVwbzogU3RyaW5nIVxuICAkaXNzdWVJZDogSW50IVxuICAkcGVyUGFnZTogSW50IVxuKSB7XG4gIHJlcG9zaXRvcnkob3duZXI6ICRvd25lciwgbmFtZTogJHJlcG8pIHtcbiAgICBpc3N1ZShudW1iZXI6ICRpc3N1ZUlkKSB7XG4gICAgICBjb21tZW50cyhcbiAgICAgICAgIi5jb25jYXQoZmlyc3RPckxhc3QsICI6ICRwZXJQYWdlXG4gICAgICAgICIpLmNvbmNhdChhZnRlck9yQmVmb3JlID09PSBudWxsID8gJycgOiAiIi5jb25jYXQoYWZ0ZXJPckJlZm9yZSwgIjogXCIiKS5jb25jYXQoY3Vyc29yLCAiXCIiKSwgIlxuICAgICAgKSB7XG4gICAgICAgIG5vZGVzIHtcbiAgICAgICAgICBpZFxuICAgICAgICAgIHJlYWN0aW9uR3JvdXBzIHtcbiAgICAgICAgICAgIHVzZXJzIChmaXJzdDogMCkge1xuICAgICAgICAgICAgICB0b3RhbENvdW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZW50XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59IikKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczkgPSBfY29udGV4dDEwLnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zOS5kYXRhOwogICAgICAgICAgICAgICAgY29tbWVudCA9IGRhdGEuZGF0YS5yZXBvc2l0b3J5Lmlzc3VlLmNvbW1lbnRzLm5vZGVzLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uaWQgPT09IGNvbW1lbnRJZDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVSZWFjdGlvbnMoY29tbWVudC5yZWFjdGlvbkdyb3VwcykpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldENvbW1lbnRSZWFjdGlvbnMoX3g5KSB7CiAgICAgICAgcmV0dXJuIF9nZXRDb21tZW50UmVhY3Rpb25zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRDb21tZW50UmVhY3Rpb25zOwogICAgfSgpCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyByZWFjdGlvbiBvZiBhIGNvbW1lbnQKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvbXV0YXRpb24vYWRkcmVhY3Rpb24vCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvaW5wdXRfb2JqZWN0L2FkZHJlYWN0aW9uaW5wdXQvCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicG9zdENvbW1lbnRSZWFjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Bvc3RDb21tZW50UmVhY3Rpb24gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMShfcmVmMTEpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGNvbW1lbnRJZCwgcmVhY3Rpb247CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWYxMS5hY2Nlc3NUb2tlbiwgY29tbWVudElkID0gX3JlZjExLmNvbW1lbnRJZCwgcmVhY3Rpb24gPSBfcmVmMTEucmVhY3Rpb247CiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgiZ3JhcGhxbCIsIHsKICAgICAgICAgICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudElkOiBjb21tZW50SWQsCiAgICAgICAgICAgICAgICAgICAgY29udGVudDogbWFwUmVhY3Rpb25OYW1lKHJlYWN0aW9uKQogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBxdWVyeTogIm11dGF0aW9uIHBvc3RDb21tZW50UmVhY3Rpb24oXG4gICRjb21tZW50SWQ6IElEISxcbiAgJGNvbnRlbnQ6IFJlYWN0aW9uQ29udGVudCEsXG4pIHtcbiAgYWRkUmVhY3Rpb24oaW5wdXQ6IHtcbiAgICBzdWJqZWN0SWQ6ICRjb21tZW50SWRcbiAgICBjb250ZW50OiAkY29udGVudFxuICB9KSB7XG4gICAgcmVhY3Rpb24ge1xuICAgICAgZGF0YWJhc2VJZFxuICAgIH1cbiAgfVxufSIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIiwgdHJ1ZSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcG9zdENvbW1lbnRSZWFjdGlvbihfeDEwKSB7CiAgICAgICAgcmV0dXJuIF9wb3N0Q29tbWVudFJlYWN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3N0Q29tbWVudFJlYWN0aW9uOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiX2dldFF1ZXJ5UGFyYW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0UXVlcnlQYXJhbXMoKSB7CiAgICAgIHZhciBfcmVmMTIgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9LAogICAgICAgICAgX3JlZjEyJHBhZ2UgPSBfcmVmMTIucGFnZSwKICAgICAgICAgIHBhZ2UgPSBfcmVmMTIkcGFnZSA9PT0gdm9pZCAwID8gdGhpcy5fcGFnZUluZm8ucGFnZSA6IF9yZWYxMiRwYWdlLAogICAgICAgICAgX3JlZjEyJHNvcnQgPSBfcmVmMTIuc29ydCwKICAgICAgICAgIHNvcnQgPSBfcmVmMTIkc29ydCA9PT0gdm9pZCAwID8gdGhpcy5fcGFnZUluZm8uc29ydCA6IF9yZWYxMiRzb3J0OwoKICAgICAgdmFyIGZpcnN0T3JMYXN0OwogICAgICB2YXIgYWZ0ZXJPckJlZm9yZTsKICAgICAgdmFyIGN1cnNvcjsKCiAgICAgIGlmIChwYWdlID09PSAxKSB7CiAgICAgICAgZmlyc3RPckxhc3QgPSBzb3J0ID09PSAnYXNjJyA/ICdmaXJzdCcgOiAnbGFzdCc7CiAgICAgICAgYWZ0ZXJPckJlZm9yZSA9IG51bGw7CiAgICAgICAgY3Vyc29yID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoc29ydCA9PT0gJ2FzYycpIHsKICAgICAgICAgIGlmIChwYWdlID4gdGhpcy5fcGFnZUluZm8ucGFnZSkgewogICAgICAgICAgICBmaXJzdE9yTGFzdCA9ICdmaXJzdCc7CiAgICAgICAgICAgIGFmdGVyT3JCZWZvcmUgPSAnYWZ0ZXInOwogICAgICAgICAgICBjdXJzb3IgPSB0aGlzLl9wYWdlSW5mby5lbmRDdXJzb3I7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmaXJzdE9yTGFzdCA9ICdsYXN0JzsKICAgICAgICAgICAgYWZ0ZXJPckJlZm9yZSA9ICdiZWZvcmUnOwogICAgICAgICAgICBjdXJzb3IgPSB0aGlzLl9wYWdlSW5mby5zdGFydEN1cnNvcjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHBhZ2UgPiB0aGlzLl9wYWdlSW5mby5wYWdlKSB7CiAgICAgICAgICAgIGZpcnN0T3JMYXN0ID0gJ2xhc3QnOwogICAgICAgICAgICBhZnRlck9yQmVmb3JlID0gJ2JlZm9yZSc7CiAgICAgICAgICAgIGN1cnNvciA9IHRoaXMuX3BhZ2VJbmZvLnN0YXJ0Q3Vyc29yOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmlyc3RPckxhc3QgPSAnZmlyc3QnOwogICAgICAgICAgICBhZnRlck9yQmVmb3JlID0gJ2FmdGVyJzsKICAgICAgICAgICAgY3Vyc29yID0gdGhpcy5fcGFnZUluZm8uZW5kQ3Vyc29yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBmaXJzdE9yTGFzdDogZmlyc3RPckxhc3QsCiAgICAgICAgYWZ0ZXJPckJlZm9yZTogYWZ0ZXJPckJlZm9yZSwKICAgICAgICBjdXJzb3I6IGN1cnNvcgogICAgICB9OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEdpdGh1YlY0Owp9KCk7CgpleHBvcnQgeyBHaXRodWJWNCBhcyBkZWZhdWx0IH07"},null]}